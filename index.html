<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>EÄŸitim Raporu</title>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<style>
 body{
   font-family:sans-serif;
   max-width:800px;
   margin:20px auto;
   background:#0f1320;
   color:#eee;
   position: relative;
 }

 /* Arkaplan resmi */
 body::before {
   content: "";
   position: fixed;
   top: 0; left: 0;
   width: 100%; height: 100%;
   background: url('logo2.png') no-repeat center center;
   background-size: cover;
   opacity: 0.5;   /* %50 opaklÄ±k */
   z-index: -1;    /* tÃ¼m iÃ§eriÄŸin arkasÄ±nda */
 }

 label{display:block;margin-top:10px;font-weight:bold}
 input,select,button{margin-top:5px;padding:8px;width:100%;border-radius:6px;border:1px solid #444;background:#1a1f36;color:#fff}
 button{cursor:pointer}
 .ok{color:#22c55e;font-weight:bold}
 .fail{color:#ef4444;font-weight:bold}
 .result{margin-top:20px;padding:15px;background:#161a2b;border-radius:8px}

/* YÃ¼klenme ekranÄ± */
#loader {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #0f1320;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
#loader img {
  width: 120px;
  height: 120px;
  animation: spin 2s linear infinite;
}
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Sayfa iÃ§inde saÄŸ-sol logolar */
.side-logo {
  position: fixed;
  top: 50%;
  width: 250px;   /* bÃ¼yÃ¼k boyut */
  transform: translateY(-50%);
  opacity: 1;     /* %100 net */
  z-index: 1;

}
.side-logo.left { left: 10px; }
.side-logo.right { right: 10px; }
</style>
</head>
<body>

<!-- YÃ¼klenme ekranÄ± -->
<div id="loader">
  <img src="logo.png" alt="Logo">
</div>

<!-- SaÄŸ ve sol logolar -->
<img src="logo.png" class="side-logo left" alt="Logo">
<img src="logo.png" class="side-logo right" alt="Logo">

<h1>ğŸ“‹ EÄŸitim Raporu Sistemi</h1>

<form id="reportForm">
  <label>Oyun Nickname <input name="nick" required></label>
  <label>RÃ¼tbe <input name="rank" required></label>
  <label>Denetlenen KiÅŸi <input name="target" required></label>
  <label>EÄŸitim TÃ¼rÃ¼ <input name="type" required></label>

  <label>FotoÄŸraflar (5 adet, sÄ±rasÄ±yla kriterler iÃ§in)
    <input type="file" name="photos" accept="image/*" multiple required>
  </label>

  <button type="submit">TaramayÄ± BaÅŸlat</button>
</form>

<div id="output" class="result" style="display:none"></div>

<button id="sendDiscord" style="display:none">Discordâ€™a GÃ¶nder</button>

<script>
// ---- Kriterler ----
const CRITERIA = [
  { name:"Kendini tanÄ±tma", keywords:["merhaba","benim adÄ±m","selam"] },
  { name:"KurallarÄ± anlatma", keywords:["kural","yasak","dikkat"] },
  { name:"Oyuna giriÅŸ", keywords:["baÅŸla","oyuna","giriÅŸ"] },
  { name:"Ä°letiÅŸim kurallarÄ±", keywords:["saygÄ±","dinlemek","iletiÅŸim"] },
  { name:"KapanÄ±ÅŸ", keywords:["iyi oyunlar","teÅŸekkÃ¼r","gÃ¶rÃ¼ÅŸÃ¼rÃ¼z"] }
];

// ---- Normalize helper ----
function normalize(str){
  const map={'Ä°':'i','I':'i','Å':'s','Ä':'g','Ãœ':'u','Ã–':'o','Ã‡':'c',
             'Ä±':'i','ÅŸ':'s','ÄŸ':'g','Ã¼':'u','Ã¶':'o','Ã§':'c'};
  return str.split('').map(ch=>map[ch]||ch).join('')
            .toLowerCase().replace(/[^\p{L}\p{N}]+/gu,' ');
}

// ---- Form Submit ----
document.getElementById("reportForm").addEventListener("submit",async e=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const files = fd.getAll("photos");

  if(files.length!==5){
    alert("LÃ¼tfen 5 fotoÄŸraf yÃ¼kleyin (her kriter iÃ§in 1).");
    return;
  }

  const nick = fd.get("nick");
  const rank = fd.get("rank");
  const target = fd.get("target");
  const type = fd.get("type");

  let report = `ğŸ“‹ EÄŸitim Raporu\nNick: ${nick}\nRÃ¼tbe: ${rank}\nDenetlenen: ${target}\nTÃ¼r: ${type}\n\n`;

  const output = document.getElementById("output");
  output.innerHTML = "<p>OCR Ã§alÄ±ÅŸÄ±yor, lÃ¼tfen bekleyin...</p>";
  output.style.display="block";

  const results=[];

  for(let i=0;i<5;i++){
    const f = files[i];
    const crit = CRITERIA[i];
    output.innerHTML += `<p>${i+1}. foto (${crit.name}) iÅŸleniyor...</p>`;
    const {data} = await Tesseract.recognize(f,"tur+eng");
    const text = normalize(data.text);
    let ok=false;
    for(const kw of crit.keywords){
      if(text.includes(normalize(kw))){ ok=true; break; }
    }
    results.push({crit:crit.name,ok});
  }

  // SonuÃ§ listesi
  output.innerHTML = "<h3>SonuÃ§:</h3>";
  results.forEach(r=>{
    output.innerHTML += `<div>${r.crit}: ${r.ok?'<span class="ok">âœ…</span>':'<span class="fail">âŒ</span>'}</div>`;
    report += `${r.ok?"âœ…":"âŒ"} ${r.crit}\n`;
  });

  // Discord butonunu hazÄ±rla
  const sendBtn=document.getElementById("sendDiscord");
  sendBtn.style.display="block";
  sendBtn.onclick=()=>{
    sendToDiscord(report);
  };
  window.finalReport = report; // kaydet
});

// ---- Discord gÃ¶nderimi ----
const WEBHOOK_URL = "https://discord.com/api/webhooks/1412178162279911536/39lLBgMg9a7V_vxMxpNgnrpnDoCF-qBKxph4-v2Kyrrl_FHKGRh9KTjCHOirnQ_82ctF"; 

async function sendToDiscord(text){
  if(!WEBHOOK_URL.startsWith("http")){
    alert("LÃ¼tfen kod iÃ§inde webhook URL'ini ayarla!");
    return;
  }
  await fetch(WEBHOOK_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({content:text})
  });
  alert("Discordâ€™a gÃ¶nderildi!");
}

// ---- Loader kapatma ----
window.addEventListener("load", () => {
  document.getElementById("loader").style.display = "none";
});
</script>

</body>
</html>
